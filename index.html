<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeySync - Ethical Key Logger</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-12">
        <div class="max-w-3xl mx-auto bg-card-bg rounded-xl shadow-md overflow-hidden border border-border-color">
            <div class="p-8">
                <div class="flex items-center justify-center mb-8">
                    <i data-feather="key" class="text-indigo-600 w-12 h-12 mr-4"></i>
                    <h1 class="text-3xl font-bold text-gray-800">KeySync</h1>
                </div>
                
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-8">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i data-feather="alert-triangle" class="h-5 w-5 text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                This is an <strong>ethical keylogger</strong> for personal use only. 
                                Use responsibly and with consent when monitoring other devices.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="space-y-6">
                    <div>
                        <h2 class="text-xl font-semibold text-gray-700 mb-2">How It Works</h2>
                        <ol class="list-decimal list-inside space-y-2 text-gray-600">
                            <li>Click Download button below</li>
                            <li>Extract ZIP to any folder</li>
                            <li>Install Python and run: pip install keyboard</li>
                            <li>Run: python keylogger.py</li>
                            <li>Type "ano" to confirm start</li>
                            <li>Press ESC to stop logging</li>
                        </ol>
                    </div>

                    <div>
                        <h2 class="text-xl font-semibold text-gray-700 mb-2">Download Package</h2>
                        <div class="flex items-center space-x-4">
                            <button id="downloadBtn" class="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition flex items-center cursor-pointer">
                                <i data-feather="download" class="mr-2"></i>
                                Download KeySync
                            </button>
                            <span class="text-sm text-gray-500" id="versionTag">v1.0.0</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2" id="downloadStatus">Size: ~2 KB | Python script included</p>
                    </div>

                    <div class="pt-4 border-t border-gray-200">
                        <h2 class="text-xl font-semibold text-gray-700 mb-2">Setup Instructions</h2>
                        <div class="bg-gray-800 rounded-lg p-4 text-gray-200 font-mono text-sm overflow-x-auto">
                            <p>1. Extract the ZIP file</p>
                            <p>2. Install Python from <span class="text-blue-400">python.org</span></p>
                            <p>3. Open terminal in folder</p>
                            <p>4. Run: <span class="text-green-400">pip install keyboard</span></p>
                            <p>5. Run: <span class="text-green-400">python keylogger.py</span></p>
                            <p>6. Type <span class="text-yellow-400">"ano"</span> to start</p>
                            <p>7. Press <span class="text-red-400">ESC</span> to stop</p>
                            <p class="text-gray-400 mt-2"># Logs saved to: ./keyloggertest/session_*.log</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-4 mt-6">
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-indigo-600">~2 KB</div>
                            <div class="text-xs text-gray-600">File Size</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-indigo-600">Win/Mac/Linux</div>
                            <div class="text-xs text-gray-600">Compatible</div>
                        </div>
                        <div class="text-center p-4 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-indigo-600">Python</div>
                            <div class="text-xs text-gray-600">Required</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="fixed bottom-4 right-4">
        <button id="themeToggle" class="p-3 rounded-full bg-indigo-600 text-white shadow-lg hover:bg-indigo-700 transition">
            <i data-feather="moon" id="themeIcon"></i>
        </button>
    </div>

    <script src="script.js"></script>
    <script>
        feather.replace();
        
        // Theme toggle 
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        let isDark = localStorage.getItem('darkMode') === 'true' || prefersDark;

        function updateTheme() {
            if (isDark) {
                document.documentElement.classList.add('dark');
                themeIcon.setAttribute('data-feather', 'sun');
            } else {
                document.documentElement.classList.remove('dark');
                themeIcon.setAttribute('data-feather', 'moon');
            }
            feather.replace(themeIcon);
        }

        themeToggle.addEventListener('click', () => {
            isDark = !isDark;
            localStorage.setItem('darkMode', isDark);
            updateTheme();
        });

        updateTheme();

        // Download button - vytvoří ZIP on-the-fly
        document.getElementById('downloadBtn').addEventListener('click', async function(e) {
            const btn = this;
            const statusEl = document.getElementById('downloadStatus');
            
            btn.disabled = true;
            btn.innerHTML = '<i data-feather="loader" class="inline mr-2 animate-spin"></i>Creating package...';
            feather.replace();
            statusEl.textContent = 'Generating ZIP file...';
            
            try {
                // Keylogger Python code
                const keyloggerCode = `# Ethical Keylogger
import keyboard
import os
from datetime import datetime
from pathlib import Path

class EthicalKeylogger:
    def __init__(self, log_dir="keyloggertest"):
        self.log_dir = Path(log_dir)
        self.log_dir.mkdir(exist_ok=True)
        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
        self.log_file = self.log_dir / f"session_{timestamp}.log"
        self.key_buffer = []
        self.buffer_size = 10
        self.is_running = False
        
    def format_key(self, event):
        key = event.name
        special_keys = {
            'space': ' ', 'enter': '\\n', 'tab': '\\t',
            'backspace': '[BACKSPACE]', 'delete': '[DELETE]',
            'shift': '[SHIFT]', 'ctrl': '[CTRL]', 'alt': '[ALT]',
            'caps lock': '[CAPS]', 'esc': '[ESC]'
        }
        return special_keys.get(key, key)
    
    def write_to_log(self, force=False):
        if not self.key_buffer or (len(self.key_buffer) < self.buffer_size and not force):
            return
        try:
            with open(self.log_file, "a", encoding="utf-8") as f:
                for entry in self.key_buffer:
                    f.write(entry)
                f.flush()
            self.key_buffer.clear()
        except Exception as e:
            print(f"Chyba při zápisu: {e}")
    
    def on_key_press(self, event):
        if not self.is_running:
            return
        if event.name == 'esc':
            self.stop()
            return
        timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]
        key = self.format_key(event)
        log_entry = f"[{timestamp}] {key}"
        self.key_buffer.append(log_entry)
        self.write_to_log()
    
    def start(self):
        self.is_running = True
        with open(self.log_file, "w", encoding="utf-8") as f:
            f.write("=== Keylogger Session Started ===\\n")
            f.write(f"Start time: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\\n")
            f.write("="*50 + "\\n\\n")
        print("✓ Keylogger běží")
        print("✓ Stiskni ESC pro ukončení\\n")
        keyboard.on_press(self.on_key_press)
        keyboard.wait('esc')
    
    def stop(self):
        if not self.is_running:
            return
        self.is_running = False
        self.write_to_log(force=True)
        with open(self.log_file, "a", encoding="utf-8") as f:
            f.write("\\n\\n" + "="*50 + "\\n")
            f.write("=== Session Ended ===\\n")
            f.write(f"End time: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\\n")
        print("\\n✓ Keylogger zastaven")
        keyboard.unhook_all()

def main():
    try:
        print("="*60)
        print("ETHICAL KEYLOGGER - pouze pro testovací účely!")
        print("="*60)
        response = input("\\nPokračovat? (ano/ne): ").strip().lower()
        if response != 'ano':
            print("Operace zrušena.")
            return
        logger = EthicalKeylogger()
        logger.start()
    except KeyboardInterrupt:
        print("\\n\\nProgram přerušen")
    except Exception as e:
        print(f"\\nChyba: {e}")

if __name__ == "__main__":
    main()`;

                const readmeContent = `KeySync - Ethical Keylogger

INSTALACE:
1. Nainstaluj Python 3.x (python.org)
2. Otevři příkazový řádek v této složce
3. Spusť: pip install keyboard
4. Spusť: python keylogger.py

POUŽITÍ:
- Program se zeptá na potvrzení
- Napiš "ano" pro spuštění
- Stiskni ESC pro ukončení
- Logy najdeš ve složce "keyloggertest"

UPOZORNĚNÍ:
⚠️ Pouze pro osobní/vzdělávací použití
⚠️ Používej zodpovědně a s vědomím ostatních
⚠️ Nikdy bez souhlasu na cizím zařízení

REQUIREMENTS:
- Python 3.x
- keyboard library

LICENCE: MIT
`;

                // Vytvoř ZIP pomocí JSZip
                const zip = new JSZip();
                zip.file("keylogger.py", keyloggerCode);
                zip.file("README.txt", readmeContent);
                
                const blob = await zip.generateAsync({type: "blob"});
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                const today = new Date().toISOString().split('T')[0].replace(/-/g, '');
                a.href = url;
                a.download = `KeySync_v${today}.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                // Success
                btn.disabled = false;
                btn.innerHTML = '<i data-feather="download" class="inline mr-2"></i>Download KeySync';
                feather.replace();
                statusEl.textContent = 'Download complete! ✓';
                
                const msg = document.createElement('div');
                msg.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                msg.innerHTML = '<i data-feather="check-circle" class="inline mr-2"></i>ZIP stažen úspěšně!';
                document.body.appendChild(msg);
                feather.replace();
                setTimeout(() => msg.remove(), 3000);
                
            } catch (error) {
                console.error('Download error:', error);
                btn.disabled = false;
                btn.innerHTML = '<i data-feather="download" class="inline mr-2"></i>Download KeySync';
                feather.replace();
                statusEl.textContent = 'Error: ' + error.message;
                
                alert('Chyba při vytváření ZIP! Zkontroluj konzoli pro detaily.');
            }
        });

        // Auto-update 
        const today = new Date();
        const versionDate = today.toISOString().split('T')[0].replace(/-/g, '');
        document.getElementById('versionTag').textContent = `v${versionDate.slice(0,8)}`;
    </script>
</body>
</html>
